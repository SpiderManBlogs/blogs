(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9997],{5836:function(ae,V,e){"use strict";var k=e(64317),$=e(85893),J=function(h){return(0,$.jsx)(k.Z,{name:"blogtype",label:"\u7C7B\u522B",request:function(){return[{label:"\u540D\u8A00",value:"1",disabled:!0},{label:"\u94FE\u63A5",value:"2",disabled:!0},{label:"\u56FE\u7247",value:"3"},{label:"\u591A\u56FE\u7247",value:"4"},{label:"\u89C6\u9891",value:"5"},{label:"\u97F3\u9891",value:"6"}]},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7C7B\u522B"}],fieldProps:{bordered:!1,disabled:!h.disabled,showArrow:!1,allowClear:!1}})};V.Z=J},22780:function(ae,V,e){"use strict";e.r(V),e.d(V,{default:function(){return je}});var k=e(48736),$=e(27049),J=e(58024),z=e(91894),h=e(3182),re=e(34792),F=e(48086),p=e(2824),te=e(94043),o=e.n(te),ne=e(952),X=e(1677),q=e(5966),le=e(90672),se=e(64317),ue=e(62747),ie=e(85224),oe=e(5836),d=e(67294),D=e(21010);function de(v){return G.apply(this,arguments)}function G(){return G=(0,h.Z)(o().mark(function v(c){return o().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,D.WY)("/api/blogs/default/save",{method:"POST",data:c}));case 1:case"end":return l.stop()}},v)})),G.apply(this,arguments)}function fe(){return L.apply(this,arguments)}function L(){return L=(0,h.Z)(o().mark(function v(){return o().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,D.WY)("/api/classification/query",{method:"GET"}));case 1:case"end":return f.stop()}},v)})),L.apply(this,arguments)}function ce(v){return N.apply(this,arguments)}function N(){return N=(0,h.Z)(o().mark(function v(c){return o().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,D.WY)("/api/file/upload",{method:"POST",data:c}));case 1:case"end":return l.stop()}},v)})),N.apply(this,arguments)}var Be=e(47673),me=e(4107),Pe=e(71153),_=e(60331),ee=e(86582),pe=e(49101),ve=e(65858),r=e(85893),ge=function(c){var f=(0,d.useState)([]),l=(0,p.Z)(f,2),y=l[0],j=l[1],E=(0,d.useState)(!1),B=(0,p.Z)(E,2),C=B[0],I=B[1],A=(0,d.useState)(""),P=(0,p.Z)(A,2),g=P[0],M=P[1],T=(0,d.useRef)(null);(0,d.useEffect)(function(){if(C){var m;(m=T.current)===null||m===void 0||m.focus()}},[]);var w=function(i){var s=y.filter(function(t){return t!==i});j(s);var a=s.map(function(t){return{name:t}});c.onChange(a)},x=function(){I(!0)},R=function(i){M(i.target.value)},U=function(){if(g&&y.indexOf(g)===-1){j([].concat((0,ee.Z)(y),[g]));var i=[].concat((0,ee.Z)(y),[g]).map(function(s){return{name:s}});c.onChange(i)}I(!1),M("")},Y=function(i){var s=(0,r.jsx)(_.Z,{closable:!0,onClose:function(t){t.preventDefault(),w(i)},children:i});return(0,r.jsx)("span",{style:{display:"inline-block"},children:s},i)},H=y.map(Y);return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{marginBottom:16},children:(0,r.jsx)(ve.Z,{enter:{scale:.8,opacity:0,type:"from",duration:100},onEnd:function(i){(i.type==="appear"||i.type==="enter")&&(i.target.style="display: inline-block")},leave:{opacity:0,width:0,scale:0,duration:200},appear:!1,children:H})}),C&&(0,r.jsx)(me.Z,{ref:T,type:"text",size:"small",style:{width:78},value:g,onChange:R,onBlur:U,onPressEnter:U}),!C&&(0,r.jsxs)(_.Z,{onClick:x,className:"site-tag-plus",children:[(0,r.jsx)(pe.Z,{})," \u6DFB\u52A0\u65B0\u6807\u7B7E"]})]})},he=ge,Te=e(71194),ye=e(34883),be=function(c){var f=(0,d.useState)(!1),l=(0,p.Z)(f,2),y=l[0],j=l[1],E=(0,d.useState)(""),B=(0,p.Z)(E,2),C=B[0],I=B[1],A=(0,d.useState)(""),P=(0,p.Z)(A,2),g=P[0],M=P[1],T=function(){j(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X.Z,{name:"images",label:"\u5C01\u9762\u56FE\u7247",max:c.imageslength,fieldProps:{name:"file",listType:"picture-card",accept:"image/*",onPreview:function(x){M(x.name),I(x.thumbUrl),j(!0)}},rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u5C01\u9762\u56FE\u7247"}],action:"/api/file/upload"}),(0,r.jsx)(ye.Z,{visible:y,title:g,footer:null,onCancel:T,children:(0,r.jsx)("img",{alt:"example",style:{width:"100%"},src:C})})]})},Se=be,Ze=e(71167),Fe=e.n(Ze),Q=null,Ce=function(){var c=(0,d.useState)(""),f=(0,p.Z)(c,2),l=f[0],y=f[1],j=(0,d.useState)(1),E=(0,p.Z)(j,2),B=E[0],C=E[1],I=(0,d.useState)(!1),A=(0,p.Z)(I,2),P=A[0],g=A[1],M=(0,d.useState)(""),T=(0,p.Z)(M,2),w=T[0],x=T[1],R=function(){if(Q==null)return F.default.error("\u56FE\u7247\u52A0\u8F7D\u5668\u52A0\u8F7D\u5931\u8D25\uFF01"),null;var a=document.createElement("input");a.setAttribute("type","file"),a.setAttribute("accept","image/*"),a.click(),a.onchange=(0,h.Z)(o().mark(function t(){var u,b,S,n,O,W,K;return o().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return u=a.files[0],b=new FormData,b.append("file",u),S=F.default.loading("\u4E0A\u4F20\u4E2D...",0),Z.next=6,ce(b);case 6:if(n=Z.sent,!n){Z.next=22;break}if(console.log("\u6587\u4EF6\u4E0A\u4F20\u540E\uFF1A",n),S(),n.status!=="ok"){Z.next=20;break}return F.default.success("\u4E0A\u4F20\u6210\u529F"),O="/api/file/queryImage/"+n.data,W=Q.getEditor(),K=W.getSelection().index,W.insertEmbed(K,"image",O),W.setSelection(K+1),Z.abrupt("return",!0);case 20:return F.default.error(n.error_msg),Z.abrupt("return",!1);case 22:case"end":return Z.stop()}},t)}))},U=(0,d.useMemo)(function(){return{toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["link","image"],["clean"]],handlers:{image:R}}}},[]),Y=["bold","italic","underline","strike","blockquote","code-block","header","list","script","indent","direction","size","color","background","font","align","link","image","clean"],H=function(){var s=(0,h.Z)(o().mark(function a(t){var u,b;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.images&&t.images.map(function(O){O.imageid=O.response.data}),t.content=l,t.multimedia=t.multimedia[0].response.data,console.log("\u8868\u5355\u6570\u636E",t),u=F.default.loading("\u6B63\u5728\u4FDD\u5B58"),n.prev=5,n.next=8,de(t);case 8:if(b=n.sent,u(),b.status!=="ok"){n.next=15;break}return F.default.success("\u4FDD\u5B58\u6210\u529F"),n.abrupt("return",!0);case 15:return F.default.error(b.error_msg),n.abrupt("return",!1);case 17:n.next=24;break;case 19:return n.prev=19,n.t0=n.catch(5),u(),F.default.error("\u4FDD\u5B58\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),n.abrupt("return",!1);case 24:case"end":return n.stop()}},a,null,[[5,19]])}));return function(t){return s.apply(this,arguments)}}(),m=function(a,t){a.blogtype&&(a.blogtype!=="4"?C(1):C(8),a.blogtype==="5"||a.blogtype==="6"?(a.blogtype==="5"?x("video/*"):x("audio/*"),g(!0)):g(!1))},i=function(a,t,u,b){y(a)};return(0,r.jsxs)(ue.ZP,{content:"\u9ED8\u8BA4\u535A\u5BA2\u6837\u5F0F\u3002",children:[(0,r.jsx)(z.Z,{bordered:!1,children:(0,r.jsxs)(ne.ZP,{style:{margin:"auto",marginTop:8,maxWidth:600},submitter:{render:function(a,t){return(0,r.jsx)(ie.Z,{children:t})}},name:"basic",layout:"vertical",initialValues:{blogtype:"3"},onValuesChange:m,onFinish:function(){var s=(0,h.Z)(o().mark(function a(t){var u;return o().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,H(t);case 2:u=S.sent,u&&D.m8.push("/blogslist");case 4:case"end":return S.stop()}},a)}));return function(a){return s.apply(this,arguments)}}(),children:[(0,r.jsx)(oe.Z,{disabled:!0}),(0,r.jsx)(Se,{imageslength:B}),(0,r.jsx)(X.Z,{name:"multimedia",label:"\u591A\u5A92\u4F53",max:1,fieldProps:{name:"file",hidden:!1,accept:w},rules:P&&[{required:!0,message:"\u8BF7\u4E0A\u4F20\u591A\u5A92\u4F53"}],action:"/api/file/upload"}),(0,r.jsx)(q.Z,{label:"\u6807\u9898",name:"title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}],placeholder:"\u8BF7\u8F93\u5165\u6807\u9898"}),(0,r.jsx)(le.Z,{label:"\u63CF\u8FF0",name:"description",fieldProps:{maxLength:1e3,showCount:!0,autoSize:!0},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u63CF\u8FF0"}],placeholder:"\u8BF7\u8F93\u5165\u63CF\u8FF0"}),(0,r.jsx)(se.Z,{name:"classify",label:"\u5206\u7C7B",request:(0,h.Z)(o().mark(function s(){var a;return o().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,fe();case 2:return a=u.sent,u.abrupt("return",a&&a.status==="ok"?a.data:[]);case 4:case"end":return u.stop()}},s)})),placeholder:"\u8BF7\u8F93\u5165\u5206\u7C7B",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u7C7B"}],fieldProps:{labelInValue:!0,fieldNames:{label:"name",value:"code",options:"id"}}}),(0,r.jsx)(q.Z,{label:"\u6807\u7B7E",name:"tags",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u7B7E"}],placeholder:"\u8BF7\u8F93\u5165\u6807\u7B7E",children:(0,r.jsx)(he,{})})]})}),(0,r.jsx)($.Z,{children:"\u5185\u5BB9"}),(0,r.jsx)(z.Z,{bordered:!1,bodyStyle:{height:"700px"},children:(0,r.jsx)(Fe(),{theme:"snow",className:"ql-editor",value:l,onChange:i,ref:function(a){Q=a},modules:U,formats:Y})})]})},je=Ce}}]);
